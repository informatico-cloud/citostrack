<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>CITOSTRACK PRO v5 (uso local)</title>
<style>
:root{
  --brand:#155eef;--brand-600:#134edb;--ink:#0b1220;--muted:#5b6575;--ui:#f5f7fb;--card:#ffffff;--border:#e4e8f1;--danger:#ef4444;--accent:#0ea5e9;--ok:#16a34a;--shadow:0 10px 30px rgba(10,30,70,.08);
}
body{margin:0;background:var(--ui);color:var(--ink);font-family:Arial,Helvetica,sans-serif}
.appbar{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--border);box-shadow:0 4px 20px rgba(0,0,0,.04);}
.appbar-inner{max-width:1200px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:14px}
.brand h1{margin:0;font-size:22px;letter-spacing:1px;font-weight:900;color:var(--brand)}
.logoPreview{max-height:40px;max-width:140px;object-fit:contain;display:none}
.uploader{display:inline-flex;align-items:center;gap:10px;padding:8px 12px;background:#eef2ff;color:#1b2b6a;border:1px dashed #c8d1ff;border-radius:10px;cursor:pointer}
.uploader:hover{background:#e2e8ff}
.container{max-width:1200px;margin:18px auto;padding:0 18px}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow)}
.card-header{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.card-title{margin:0;font-size:15px;color:#1b2648;font-weight:800}
.actions{display:flex;flex-wrap:wrap;gap:10px}
.btn{border:0;border-radius:10px;padding:10px 14px;font-weight:800;cursor:pointer;background:var(--brand);color:#fff}
.btn.alt{background:var(--accent)}.btn.danger{background:var(--danger)}.btn.ok{background:var(--ok)}.btn.ghost{background:#eef2ff;color:#1b2b6a}
.btn:hover{background:var(--brand-600)}
.table-wrap{overflow:auto}
table{width:100%;border-collapse:collapse;min-width:960px}
th,td{border:1px solid var(--border);font-size:13px}
th{background:#f8faff;font-weight:800;padding:10px;text-align:center}
td{background:#fff;padding:4px}
tbody tr:nth-child(even) td{background:#fbfcff}
tfoot td{background:#f2f6ff;font-weight:800;padding:8px}
.hint{text-align:center;color:var(--muted);font-size:12px;margin:10px 0}
</style>
</head>
<body>
<header class="appbar">
  <div class="appbar-inner">
    <div class="brand">
      <img id="logoPreview" class="logoPreview" alt="Logo">
      <label class="uploader">
        <input id="i_logo" type="file" accept="image/png,image/jpeg" style="display:none">
        üñºÔ∏è Cargar logo institucional
      </label>
      <div>
        <h1>CITOSTRACK</h1>
        <small>ICC = (Preparaciones + Administraciones) / Tiempo (min)</small>
      </div>
    </div>
    <div class="actions">
      <button class="btn ghost" id="btnLimpiar">Limpiar</button>
      <button class="btn alt" id="btnGenerar">Exportar PDF</button>
    </div>
  </div>
</header>
<main class="container">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Registro de funcionarios</h3>
      <div class="actions">
        <button class="btn ok" id="btnAdd">+ Nuevo registro</button>
        <button class="btn danger" id="btnRem">‚Äì Eliminar seleccionados</button>
      </div>
    </div>
    <div class="card-body">
      <div class="table-wrap">
        <table id="tabla">
          <thead>
            <tr>
              <th>Sel</th><th>Nombre</th><th>RUT</th><th>Fecha evaluaci√≥n</th><th>Semana</th><th># Preparaciones</th><th># Administraciones</th><th>Tiempo (min)</th><th>ICC</th><th>Observaciones</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
          <tfoot>
            <tr><td colspan="5" style="text-align:right">Totales:</td><td id="tPrep">0</td><td id="tAdm">0</td><td id="tMin">0</td><td id="tIcc">0.00</td><td></td></tr>
          </tfoot>
        </table>
      </div>
      <p class="hint">La <b>Semana</b> se calcula autom√°ticamente seg√∫n la fecha, y el <b>ICC</b> se actualiza en tiempo real.</p>
    </div>
  </div>
</main>
<script>

document.getElementById("btnAdd").onclick=addRow;
document.getElementById("btnRem").onclick=removeSelected;
document.getElementById("btnLimpiar").onclick=()=>{if(confirm("¬øBorrar todos los registros?")){rows=[emptyRow()];save();render();}};
document.getElementById("btnGenerar").onclick=()=>{recalcAndPaint();save();window.print();};
load();})();
</script>
</body></html>
